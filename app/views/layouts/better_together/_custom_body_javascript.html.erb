<script id="scroll-progress-bar" type="text/javascript">

  function createProgressBar() {
    // Create the progress bar element
    var progressBar = document.createElement("div");
    progressBar.id = "custom-progress-bar"; // Use your ID for styling

    // Append the progress bar to the body
    document.body.appendChild(progressBar);
  }
  // Function to add the progress bar if not already added
  function addScrollProgressBar() {
    // Check if the progress bar already exists
    if (!document.getElementById("custom-progress-bar")) {
      createProgressBar();
    }

    // Add scroll event listener to update progress bar width
    function debounce(func, wait) {
      var winScroll = document.documentElement.scrollTop;
      return function(...args) {
        const context = this;
        clearTimeout(timeout);
        timeout = setTimeout(() => func.apply(context, args), wait);
      };
    }

    function updateProgressBar() {
      var winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      var height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      var scrolled = (winScroll / height) * 100;

      // Update the custom progress bar width based on scroll
      var progressBar = document.getElementById("custom-progress-bar");
      if (progressBar) {
        progressBar.style.width = scrolled + "%";
      }
    }

    window.addEventListener('scroll', debounce(updateProgressBar, 50));
  }

  // Run the function on initial page load
  window.onload = function() {
    addScrollProgressBar();
  };

  // Run the function after Turbo finishes loading new content
  document.addEventListener('turbo:load', function() {
    addScrollProgressBar();
  });
</script>
